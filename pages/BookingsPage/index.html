<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-EBEHV0GZH5"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-EBEHV0GZH5');
        </script>   

        <!-- Meta tags -->
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
        <title>Xaviers Flights - Bookings</title>

        <!-- Favicon -->
        <link rel="apple-touch-icon" sizes="180x180" href="../../images/favicon/apple-touch-icon.png">
        <link
            rel="icon"
            type="image/png"
            sizes="32x32"
            href="../../images/favicon/favicon-32x32.png"
        >
        <link
            rel="icon"
            type="image/png"
            sizes="16x16"
            href="../../images/favicon/favicon-16x16.png"
        >
        <link rel="manifest" href="../../images/favicon/site.webmanifest">

        <!-- CSS -->
        <link rel="stylesheet" href="../../css/bootstrap.min.css" crossorigin="anonymous">
        <script src="../../js/jquery-3.3.1.slim.min.js" text="type/javascript"></script>
        <link rel="stylesheet" href="../../css/style.css">
        <script src="../../js/config.js"></script>
        <script src="../../js/auth.js"></script>
        <script src="../../js/main.js"></script>
    </head>

    <body style="background-color: #D5ECEA;">

        <!-- Navbar -->
        <nav class="navbar navbar-expand-lg" style="background-color: #04A289;">
            <!-- Image and text -->
            <nav class="navbar navbar-light">
                <a class="navbar-brand" href="#">
                    <div class="container text-center" style="margin-top: -1.5%;">
                        <div class="row align-items-start">
                            <div class="col">
                                <img
                                    src="../../images/Crest.png"
                                    style="margin-top: -5%;"
                                    width="34"
                                    height="40"
                                    class="d-inline-block align-top"
                                    alt=""
                                >
                            </div>
                            <div class="col" style="margin-left: -15%;">
                                <span style="color: #fedebad7; font-family: Poppins-Medium,Courier ">Xaviers Flights</span>
                            </div>
                        </div>
                    </a>
                </nav>
                <button
                    class="navbar-toggler custom-toggler"
                    type="button"
                    data-toggle="collapse"
                    data-target="#navbarSupportedContent"
                    aria-controls="navbarSupportedContent"
                    aria-expanded="false"
                    aria-label="Toggle navigation"
                >
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav mr-auto" style="opacity: 0.98;">
                        <li class="nav-item active">
                            <a class="nav-link" href="../../index.html">Home
                                <span class="sr-only">(current)</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Bookings</a>
                        </li>
                        <li class="nav-item dropdown">
                            <a
                                class="nav-link dropdown-toggle"
                                href="#"
                                id="navbarDropdown"
                                role="button"
                                data-toggle="dropdown"
                                aria-haspopup="true"
                                aria-expanded="false"
                            >
                                Flights
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                <a class="dropdown-item" href="../Flights/InternationalFlights/index.html">International</a>
                                <a class="dropdown-item" href="../Flights/DomesticFlights/index.html">Domestic</a>
                            </div>
                        </li>
                        <li class="nav-item">
                            <a
                                class="nav-link nvd except "
                                href="#"
                                tabindex="-1"
                                aria-disabled="true"
                                id="myaccount"
                            >My Account</a>
                        </li>
                        <li class="nav-item">
                            <button type="button" class="btn btn-info" id="signinbutton">
                                Sign In/Register
                            </button>
                        </li>
                    </ul>
                    <form class="form-inline my-2 my-lg-0" style="margin-right: 3%; opacity: 0.95;">
                        <input
                            class="form-control mr-sm-2"
                            type="search"
                            placeholder="Search for flights"
                            aria-label="Enter search here"
                        >
                        <button class="btn btn-outline-light my-2 my-sm-0" type="submit">Search</button>
                    </form>
                </div>
            </nav>

            
            <br>
            <div class="jumbotron jumbotron-fluid">
                <div class="container">
                    <h1 class="display-4">Your Bookings, <span id="usernamep"></span></h1>
                    <br>
                    <!-- <p class="lead">This is the homepage of the website.</p> -->
                </div>
            </div>

            <div class="bookings" id="bookings">
                <!-- Bookings will be dynamically loaded here -->
            </div>
            
            <!-- Modal for Boarding Pass -->
            <div class="modal fade" id="boardingPassModal" tabindex="-1" role="dialog" aria-labelledby="boardingPassModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="boardingPassModalLabel">Boarding Pass</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body" id="boardingPassContent">
                            <!-- Boarding pass will be displayed here -->
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary" onclick="printBoardingPass()">Print</button>
                        </div>
                    </div>
                </div>
            </div>


            <!-- JS -->
            <script src="../../js/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
            <script src="../../js/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
            <script src="../../js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
            <script>
            // Load all bookings from localStorage
            function loadBookings() {
                const bookingsContainer = document.getElementById('bookings');
                const allBookings = JSON.parse(localStorage.getItem('allBookings')) || [];
                
                if(allBookings.length === 0) {
                    bookingsContainer.innerHTML = `
                        <div class="container text-center" style="margin-top: 50px;">
                            <h3>No bookings found</h3>
                            <p>You haven't made any flight bookings yet.</p>
                            <a href="../../index.html" class="btn btn-primary">Search Flights</a>
                        </div>
                    `;
                    return;
                }
                
                let bookingsHTML = '<div class="container-fluid" style="padding: 0 40px;">';
                
                allBookings.forEach((booking, index) => {
                    bookingsHTML += `
                        <div class="card mb-3" style="border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border-left: 5px solid #04A289;">
                            <div class="card-body" style="background: linear-gradient(135deg, #04A289 0%, #5faf8a 100%); color: white; border-radius: 10px 10px 0 0;">
                                <div class="row align-items-center">
                                    <div class="col-md-6">
                                        <h5 class="card-title mb-0" style="font-weight: bold; font-size: 24px;">${booking.airline}</h5>
                                    </div>
                                    <div class="col-md-6 text-md-right">
                                        <h6 class="mb-0" style="font-size: 18px;">
                                            <strong>${booking.from}</strong> ✈️ <strong>${booking.to}</strong>
                                        </h6>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body" style="background: white;">
                                <div class="row align-items-center">
                                    <div class="col-md-2">
                                        <p class="mb-1"><strong>Date:</strong></p>
                                        <p class="text-muted">${booking.fromDate}</p>
                                    </div>
                                    <div class="col-md-2">
                                        <p class="mb-1"><strong>Class:</strong></p>
                                        <p class="text-muted">${booking.travelClass}</p>
                                    </div>
                                    <div class="col-md-2">
                                        <p class="mb-1"><strong>Seat:</strong></p>
                                        <p class="text-muted" style="font-size: 18px; font-weight: bold; color: #04A289;">${booking.seatNumber}</p>
                                    </div>
                                    <div class="col-md-2">
                                        <p class="mb-1"><strong>Price:</strong></p>
                                        <p class="text-muted">${booking.price}</p>
                                    </div>
                                    <div class="col-md-2">
                                        <p class="mb-1"><strong>Type:</strong></p>
                                        <p class="text-muted">${booking.tripType}</p>
                                    </div>
                                    <div class="col-md-2 text-right">
                                        <button class="btn btn-success btn-lg" style="background-color: #04A289; border: none;" onclick="viewBoardingPass(${index})">
                                            View Pass
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                bookingsHTML += '</div>';
                bookingsContainer.innerHTML = bookingsHTML;
            }
            
            // View boarding pass in modal
            function viewBoardingPass(index) {
                const allBookings = JSON.parse(localStorage.getItem('allBookings')) || [];
                const booking = allBookings[index];
                
                if(!booking) return;
                
                // Extract airport codes
                const fromMatch = booking.from.match(/\(([^)]+)\)/);
                const fromCode = fromMatch ? fromMatch[1] : booking.from.substring(0, 3).toUpperCase();
                
                const toMatch = booking.to.match(/\(([^)]+)\)/);
                const toCode = toMatch ? toMatch[1] : booking.to.substring(0, 3).toUpperCase();
                
                const boardingPassHTML = `
                    <div style="max-width: 600px; margin: 0 auto; padding: 20px; background: white; border: 2px solid #ddd; border-radius: 10px; border-left: 5px solid #04A289;">
                        <div style="text-align: center; border-bottom: 2px dashed #ccc; padding-bottom: 20px; margin-bottom: 20px;">
                            <h2 style="color: #04A289; margin: 0;">${booking.airline}</h2>
                            <p style="margin: 5px 0; color: #666;">BOARDING PASS</p>
                        </div>
                        
                        <div style="display: flex; justify-content: space-around; margin-bottom: 20px;">
                            <div style="text-align: center;">
                                <div style="font-size: 32px; font-weight: bold; color: #333;">${fromCode}</div>
                                <div style="color: #666; font-size: 12px;">FROM</div>
                            </div>
                            <div style="text-align: center; padding-top: 10px;">
                                <svg width="60" height="30" viewBox="0 0 60 30">
                                    <path d="M10 15 L50 15" stroke="#04A289" stroke-width="2" fill="none"/>
                                    <path d="M45 10 L50 15 L45 20" stroke="#04A289" stroke-width="2" fill="none"/>
                                </svg>
                            </div>
                            <div style="text-align: center;">
                                <div style="font-size: 32px; font-weight: bold; color: #333;">${toCode}</div>
                                <div style="color: #666; font-size: 12px;">TO</div>
                            </div>
                        </div>
                        
                        <div style="border: 2px solid #f0f0f0; border-radius: 8px; padding: 15px; background: #f9f9f9;">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                <div>
                                    <div style="color: #666; font-size: 11px; text-transform: uppercase;">Passenger Name</div>
                                    <div style="font-weight: bold; font-size: 14px;">${booking.passengerName}</div>
                                </div>
                                <div>
                                    <div style="color: #666; font-size: 11px; text-transform: uppercase;">Flight No.</div>
                                    <div style="font-weight: bold; font-size: 14px;">${booking.flightNumber}</div>
                                </div>
                                <div>
                                    <div style="color: #666; font-size: 11px; text-transform: uppercase;">Date</div>
                                    <div style="font-weight: bold; font-size: 14px;">${booking.fromDate}</div>
                                </div>
                                <div>
                                    <div style="color: #666; font-size: 11px; text-transform: uppercase;">Gate</div>
                                    <div style="font-weight: bold; font-size: 14px;">${booking.gate}</div>
                                </div>
                                <div>
                                    <div style="color: #666; font-size: 11px; text-transform: uppercase;">Seat</div>
                                    <div style="font-weight: bold; font-size: 18px; color: #04A289;">${booking.seatNumber}</div>
                                </div>
                                <div>
                                    <div style="color: #666; font-size: 11px; text-transform: uppercase;">Class</div>
                                    <div style="font-weight: bold; font-size: 14px;">${booking.travelClass}</div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 20px; text-align: center; border-top: 2px dashed #ccc; padding-top: 20px;">
                            <div style="background: #333; height: 60px; background-image: repeating-linear-gradient(90deg, #000 0px, #000 2px, #fff 2px, #fff 4px);"></div>
                            <p style="margin-top: 10px; color: #999; font-size: 12px;">Please arrive at the gate 30 minutes before departure</p>
                        </div>
                    </div>
                `;
                
                document.getElementById('boardingPassContent').innerHTML = boardingPassHTML;
                $('#boardingPassModal').modal('show');
            }
            
            // Print boarding pass
            function printBoardingPass() {
                const printContent = document.getElementById('boardingPassContent').innerHTML;
                const originalContent = document.body.innerHTML;
                document.body.innerHTML = printContent;
                window.print();
                document.body.innerHTML = originalContent;
                location.reload();
            }
            
            // Load bookings when page loads
            window.addEventListener('DOMContentLoaded', loadBookings);
            </script>



            <!-- Site footer -->
            <footer class="site-footer">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 col-md-6">
                            <h6>About</h6>
                            <p class="text-justify">Xaviers Airline is a commercial flight booking company recognized internationally which aims to provide booking services online to customers who wish to travel via airways both domestic and cross-country.
                                <br>
                                Our primary vision is to provide leisure and hassle-free user experience from booking to reaching your destination.
                          Hope you have a good time with us.
                                <br>
                                <br>
                                For any queries or complaints, please feel free to reach out to us on our mail xaviersairline@gmail.com and we'll get back to you on the earliest.
                            </p>
                        </div>
                        <div class="col-xs-6 col-md-3">
                            <h6>Contact Us</h6>
                            <ul class="footer-links">
                                <li>Office: 5, Mahapalika Marg, Dhobi Talao, Chhatrapati Shivaji Terminus Area, Fort, Mumbai, Maharashtra 400001</li>
                                <li></li>
                                <li>Phone: 022-22620661</li>
                                <br>
                                <li>Email: xaviersairline@gmail.com</li>
                            </ul>
                        </div>
                        <div class="col-xs-6 col-md-3">
                            <h6>Quick Links</h6>
                            <ul class="footer-links">
                                <li>
                                    <a href="http://scanfcode.com/about/">About Us</a>
                                </li>
                                <li>
                                    <a href="http://scanfcode.com/contact/">Contact Us</a>
                                </li>
                                <li>
                                    <a href="http://scanfcode.com/contribute-at-scanfcode/">Contribute</a>
                                </li>
                                <li>
                                    <a href="http://scanfcode.com/privacy-policy/">Privacy Policy</a>
                                </li>
                                <li>
                                    <a href="http://scanfcode.com/sitemap/">Sitemap</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <hr>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-8 col-sm-6 col-xs-12">
                            <p class="copyright-text">
                                Copyright &copy; 2023 All Rights Reserved by
                                <a href="#">Noel Pinto & Pratik Sahare - St Xavier's College Mumbai</a>
                                .
                            </p>
                        </div>
                        <div class="col-md-4 col-sm-6 col-xs-12">
                            <ul class="social-icons">
                                <li>
                                    <a class="github" href="#">
                                        <i class="fa fa-dribbble"></i>
                                    </a>
                                </li>
                                <li>
                                    <a class="xaviers_website" href="#">
                                        <i class="fa fa-linkedin"></i>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </footer>
        </body>
    </html>
